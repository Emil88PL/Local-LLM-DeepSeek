<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <title>Ollama Chat</title>
</head>
<body>
<h1>Ollama Chat</h1>

<pre id="output"></pre>

<!-- Thinking Indicator -->
<div class="thinking-overlay" id="thinking-overlay">
    <div class="thinking-content">
        <div class="spinner"></div>
        Thinking...
    </div>
</div>

<textarea id="input" placeholder="Type your message here..."></textarea>
<select name="llm" id="llm">
    <option value="1.5b" selected>1.5b</option>
    <option value="1.8b">1.8b</option>
    <option value="14b">14b</option>
</select>
<button id="send">Send</button>

<!-- Think Placeholder -->
<div id="think-placeholder" class="think-placeholder"></div>

<script>
    async function sendPromptToOllama(prompt, modelLlm) {
        const url = 'http://127.0.0.1:11434/api/generate';
        const data = {
            model: 'deepseek-r1:' + modelLlm,
            prompt: prompt,
            stream: false,
        };

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            });

            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const result = await response.json();
            return result.response;
        } catch (error) {
            console.error('Error sending prompt to Ollama:', error);
        }
    }

    document.getElementById('send').addEventListener('click', async () => {
        const modelLlm = document.getElementById('llm').value;
        const input = document.getElementById('input').value;
        const output = document.getElementById('output');
        const thinkingOverlay = document.getElementById('thinking-overlay');
        output.style.display = 'block';
        if (input) {
            // Show the thinking overlay
            thinkingOverlay.style.display = 'flex';

            // Send the prompt and wait for the response
            const response = await sendPromptToOllama(input, modelLlm);

            // Hide the thinking overlay
            thinkingOverlay.style.display = 'none';

            // Display the response
            output.textContent += `You: ${input}\nOllama: ${response}\n\n`;
            document.getElementById('input').value = ''; // Clear input
            output.scrollTop = output.scrollHeight; // Auto-scroll to bottom
            console.log(modelLlm);
            // \u003cthink\u003e\n\n\u003c/think\u003e\n
        }
    });
</script>
</body>
</html>